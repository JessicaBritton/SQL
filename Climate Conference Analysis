Climate Conference Project
Database: https://www.db-fiddle.com/f/pxMci1sLL945KHKYvpe9W6/1

-- Analysis:

-- 1. [LEFT JOIN] List all the VIPs (last and first name) and any panels they are presenting at. 
SELECT
	VIPS.LAST_NAME,
    VIPS.FIRST_NAME,
    EVENTS.EVENT_ID
FROM
	VIPS
LEFT JOIN 
	EVENTS
	ON VIPS.EVENT = EVENTS.EVENT_ID;

-- 2. [INNER JOIN] Which VIPs are presenting at events? Include the VIPs first and last name, the event name, and what type of event it is.
SELECT
	VIPS.FIRST_NAME,
    VIPS.LAST_NAME,
    EVENTS.EVENT_NAME,
    EVENTS.EVENT_TYPE
FROM VIPS
INNER JOIN
	EVENTS
    ON VIPS.EVENT = EVENTS.EVENT_ID;

-- 3. [Multiple JOINs in one query] List all the VIPs and their hotel reservations. Include the VIPs first and last name, hotel name, and address.
SELECT
	VIPS.FIRST_NAME,
    VIPS.LAST_NAME,
    HOTELS.HOTEL_NAME,
    HOTELS.ADDRESS
FROM
	VIPS
LEFT JOIN
	RESERVATIONS
    ON VIPS.MEMBER_ID = RESERVATIONS.MEMBER_ID
LEFT JOIN
	HOTELS
    ON RESERVATIONS.HOTEL = HOTELS.HOTEL_ID;

-- 4. [Query with a subquery] Find VIPs staying at the hotel with the most reservations.
SELECT 
	V.FIRST_NAME,
    V.LAST_NAME,
    H.HOTEL_NAME
FROM
	VIPS AS V
JOIN
	RESERVATIONS AS R
    ON V.MEMBER_ID = R.MEMBER_ID
JOIN 
	HOTELS AS H
    ON R.HOTEL = H.HOTEL_ID
WHERE
	R.HOTEL = (
      SELECT
      	HOTEL
      FROM
      	RESERVATIONS
      GROUP BY
      	HOTEL
      ORDER BY COUNT(*) DESC
      LIMIT 1);

-- 5. [Query with a SELF JOIN] Find VIPs who provide feedback to others and the corresponding VIPs who receive their feedback.
SELECT
	V1.FIRST_NAME AS FEEDBACK_GIVER,
    V1.LAST_NAME AS GIVER_LAST,
    V2.FIRST_NAME AS FEEDBACK_RECEIVER,
    V2.LAST_NAME AS RECEIVER_LAST
FROM VIPS AS V1
JOIN
	VIPS AS V2
    ON V1.PROVIDES_FEEDBACK_TO = V2.MEMBER_ID;

-- 6. Custom Query: List all the VIPS and if they have RSVP'd to the welcome or dinner reservations.
SELECT
	V.FIRST_NAME,
    V.LAST_NAME,
    R.WELCOME_RSVP,
    R.DINNER_RSVP
FROM 
	VIPS AS V
LEFT JOIN
	RESERVATIONS AS R
    ON V.MEMBER_ID = R.MEMBER_ID;

-- 7. Custom Query: Get a list of all government-affiliated VIPs who have RSVPâ€™d for dinner.
SELECT
	V.FIRST_NAME,
    V.LAST_NAME,
    V.ASSOCIATION
FROM
	VIPS AS V
JOIN
	RESERVATIONS AS R
    ON V.MEMBER_ID = R.MEMBER_ID
WHERE
	V.ASSOC_TYPE = 'government'
    AND
    R.DINNER_RSVP = 1; 

-- 8. Custom Query: Find the number of VIPs attending each event, ordered by event attendance.
SELECT
	E.EVENT_NAME,
    COUNT(V.MEMBER_ID) AS ATTENDEE_COUNT
FROM
	EVENTS AS E
LEFT JOIN
	VIPS AS V
    ON E.EVENT_ID = V.EVENT
GROUP BY E.EVENT_NAME
ORDER BY ATTENDEE_COUNT DESC;




-- This analysis utilized the following Climate Conference dataset:

CREATE TABLE vips (
     member_id INTEGER PRIMARY KEY
   , last_name TEXT
   , first_name TEXT
   , event INTEGER
   , provides_feedback_to INTEGER
   , association TEXT
   , assoc_type TEXT
   , member_since INTEGER
   );
   
CREATE TABLE reservations ( 
    member_id INTEGER
  , hotel INTEGER
  , welcome_rsvp BIT
  , dinner_rsvp BIT
  );
 
 
CREATE TABLE events (
    event_id INTEGER PRIMARY KEY
  , event_name TEXT
  , event_type TEXT
  );
  

CREATE TABLE hotels (
    hotel_id INTEGER PRIMARY KEY
  , hotel_name TEXT
  , address TEXT
  );


INSERT INTO vips VALUES
(2814, 'Fletcher', 'David', 5, 3742, 'Anishinabek Educational Institute', 'education', 2004)
,(1944, 'Kim', 'Jiho', 4, 4230, 'Appalachian State', 'education', 1991)
,(3889, 'Kowalski', 'Alex', 9, 3460, 'Brigg & McKinnnon AEC', 'private', 2015)
,(3775, 'Al-Hassan', 'Amina', 6, 3891, 'California Department of Water Resources', 'government', 2013)
,(4003, 'Chang', 'Nathan', 8, 3960, 'Chang Engineers, LLC', 'private', 2017)
,(3490, 'Anderson', 'Shanae', 2, 4315, 'Chicago Department of Public Health', 'government', 2008)
,(3077, 'Murphy', 'Aisling', 3, 2731, 'Climate Impacts on Farming Institute', 'research', 2006)
,(3960, 'Ivanov', 'Dmitri', 6, 2814, 'Cooperative Institute for Climate, Ocean, and Ecosystem Studies', 'research', 2016)
,(4402, 'Bennett', 'Leah', NULL, NULL, 'Denver Climate Research Foundation', 'research', 2024)
,(3891, 'Roy', 'Harper', 4, 3077, 'Environmental Science Associates', 'private', 2015)
,(4386, 'Silva', 'Thiago', NULL, NULL, 'Everglades Research Institute', 'research', 2023)
,(4297, 'Chukwu', 'Ifeoma', 9, 2716, 'Georgia State University', 'education', 2020)
,(3189, 'Martinez', 'Isabella', 8, 2011, 'Iowa State University', 'education', 2007)
,(3491, 'Gonzalez', 'Victor', 5, 3047, 'McGill University', 'education', 2008)
,(3742, 'Brown', 'Timothy', 3, 3490, 'Michigan State University', 'education', 2012)
,(4361, 'Riley', 'Daniel', 6, 1944, 'Minnesota Water Board', 'education', 2023)
,(1934, 'Garcia', 'Mateo', NULL, NULL, 'Oklahoma Department of Wildlife Conservation', 'government', 1990)
,(2011, 'Patel', 'Anika', 7, 3491, 'Renewable Energy Research Center, Honolulu', 'research', 1995)
,(4315, 'Shepherd', 'Priya', 10, 4003, 'Tech517', 'private', 2022)
,(1738, 'Johnson', 'Denny', NULL, NULL, 'Texas Department of Conservation and Natural Resources', 'government', 1987)
,(4230, 'Parker', 'Moss', 2, 3719, 'University of California, Davis', 'education', 2019)
,(2731, 'Rivera', 'Juan', 1, 4297, 'University of Montana', 'education', 2003)
,(2091, 'Haines', 'Keisha', 11, 3189, 'University of North Carolina', 'education', 1998)
,(2551, 'Nguyen', 'Linh', 2, 2091, 'University of Pennsylvania', 'education', 2002)
,(3047, 'Singh', 'Aarav', 4, 2551, 'US Department of Fish and Wildlife', 'government', 2005)
,(4112, 'Fernandez', 'Lucia', NULL, NULL, 'US Department of Fish and Wildlife', 'government', 2018)
,(3719, 'Denton', 'K. L.', 11, 3889, 'US Department of Housing and Urban Development', 'government', 2011)
,(3460, 'Chen', 'Beverly', 7, 4361, 'US Department of Natural Resources', 'government', 2008)
,(2716, 'Rodriguez', 'Sofia', 7, 3775, 'US Department of Renewable Energy', 'government', 2003)
,(2800, 'Lee', 'Min-Jun', NULL, NULL, 'US Department of Renewable Energy', 'government', 2004)
;


INSERT INTO reservations VALUES
 (3491,  1, 1, 1)
,(4361,  1, 1, 1)
,(3047,  2, 1, 1)
,(3775,  1, 1, 1)
,(4003,  3, 0, 1)
,(4402,  2, 1, 1)
,(3891,  3, 1, 1)
,(2011,  1, 1, 1)
,(4808,  2, 1, 1)
,(3490,  1, 0, 1)
,(3189,  1, 1, 1)
,(1944,  1, 0, 1)
,(2716,  2, 0, 1)
,(2551,  2, 1, 1)
,(4386,  2, 0, 1)
,(2814,  3, 1, 1)
,(1738,  2, 0, 1)
,(3960,  1, 1, 1)
,(4315,  3, 1, 0)
,(4722,  2, 1, 1)
,(2731,  3, 1, 1)
,(2091,  1, 1, 0)
,(3889,  3, 1, 1)
,(3742,  2, 0, 1)
,(3719,  2, 0, 1)
,(3460,  2, 1, 1)
,(3077,  2, 0, 1)
,(4420,  1, 1, 0)
,(2800,  2, 0, 1)
,(1934,  3, 1, 1)
;


INSERT INTO events VALUES
  (1, 'Climate Change Communication: Engaging the Public and Policy Makers', 'Keynote')
, (2, 'Climate Change and Public Health: Risks and Responses', 'Panel')
, (3, 'Climate Change and Agriculture: Ensuring Food Security', 'Panel')
, (4, 'Biodiversity and Ecosystem Services in a Changing Climate', 'Panel')
, (5, 'Indigenous Knowledge and Climate Change Adaptation', 'Panel')
, (6, 'The Role of Oceans in Climate Change: Impacts and Solutions', 'Panel')
, (7, 'Climate Change and Renewable Energy: Innovations and Challenges', 'Panel')
, (8, 'Climate Justice and Equity: Addressing Disproportionate Impacts', 'Panel')
, (9, 'The Economic Impact of Climate Change: Costs and Opportunities', 'Panel')
, (10, 'Technological Innovations for Climate Monitoring and Assessment', 'Workshop')
, (11, 'Urban Resilience: Designing Climate-Smart Cities', 'Workshop')
, (12, 'The Role of Policy in Combating Climate Change', 'Workshop')
;


INSERT INTO hotels VALUES
   (1, 'Hyatt Downtown', '392 South Main Street, Cityville, PA')
 , (2, 'Marriott', '1240 Marshall Avenue, Cityville, PA')
 , (3, 'Four Season''s', '900 Winter Road, Cityville, PA')
 ;

